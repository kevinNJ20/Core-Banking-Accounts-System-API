#%RAML 1.0
title: Core Banking Accounts System API
version: 1.0.1
mediaType: application/json

documentation:
  - title: Overview
    content: API système pour gérer les comptes bancaires dans le système Core Banking

types:
  FinancialAccount:
    type: object
    properties:
      id?: string
      accountNumber: string
      accountType: string
      accountName?: string
      currency?: string
      balance?: number
      availableBalance?: number
      owners:
        type: array
        items:
          type: object
          properties:
            customerId: string
            relationshipType: string
    example:
      accountNumber: "ACC-123456789"
      accountType: "Checking"
      accountName: "Main Checking Account"
      currency: "USD"
      balance: 5000.00
      availableBalance: 4800.00
      owners:
        - customerId: "c1c27e05-7e59-4f39-a7f6-7ffe9ee10d64"
          relationshipType: "Primary"
      status: "Active"
  FinancialTransaction:
    type: object
    properties:
      id?: string
      transactionNumber: string
      accountId: string
      transactionType: string
      amount: number
      currency?: string
      transactionDate: datetime
      description?: string
      status?: string
    example:
      transactionNumber: "TXN-20260128-001"
      accountId: "a289c8d1-9df9-48a8-8e45-4d5e2f573ee5"
      transactionType: "Debit"
      amount: 100.00
      currency: "USD"
      transactionDate: "2026-01-28T10:30:00Z"
      description: "Purchase at Store XYZ"
      status: "Posted"
  ErrorResponse:
    type: object
    properties:
      error:
        type: object
        properties:
          code: string
          message: string
    example:
      error:
        code: "NOT_FOUND"
        message: "Account not found"

traits:
  hasQueryParam:
    queryParameters:
      limit:
        type: integer
        required: false
        default: 100
      offset:
        type: integer
        required: false
        default: 0

/accounts:
  displayName: Accounts
  description: Opérations sur les comptes bancaires
  
  get:
    displayName: Get Accounts
    description: Récupère la liste des comptes avec filtres optionnels
    is: [hasQueryParam]
    queryParameters:
      customerId:
        type: string
        required: false
      accountNumber:
        type: string
        required: false
      accountType:
        type: string
        required: false
      status:
        type: string
        required: false
    responses:
      200:
        body:
          application/json:
            type: FinancialAccount[]
      400:
        body:
          application/json:
            type: ErrorResponse
      500:
        body:
          application/json:
            type: ErrorResponse

  post:
    displayName: Create Account
    description: Crée un nouveau compte
    body:
      application/json:
        type: FinancialAccount
        example:
          accountNumber: "ACC-123456789"
          accountType: "Checking"
          accountName: "Main Checking Account"
          currency: "USD"
          balance: 5000.00
          availableBalance: 4800.00
          status: "Active"
          owners:
            - customerId: "c1c27e05-7e59-4f39-a7f6-7ffe9ee10d64"
              relationshipType: "Primary"
    responses:
      201:
        body:
          application/json:
            type: FinancialAccount
      400:
        body:
          application/json:
            type: ErrorResponse

  /{accountId}:
    displayName: Account by ID
    uriParameters:
      accountId:
        type: string
    
    get:
      displayName: Get Account by ID
      responses:
        200:
          body:
            application/json:
              type: FinancialAccount
        404:
          body:
            application/json:
              type: ErrorResponse
    
    put:
      displayName: Update Account
      body:
        application/json:
          type: FinancialAccount
          example:
            accountNumber: "ACC-123456789"
            accountType: "Checking"
            accountName: "Main Checking Account"
            currency: "USD"
            balance: 5000.00
            availableBalance: 4800.00
            status: "Active"
            owners:
              - customerId: "c1c27e05-7e59-4f39-a7f6-7ffe9ee10d64"
                relationshipType: "Primary"
      responses:
        200:
          body:
            application/json:
              type: FinancialAccount

    /transactions:
      displayName: Account Transactions
      get:
        displayName: Get Account Transactions
        responses:
          200:
            body:
              application/json:
                type: FinancialTransaction[]
      post:
        displayName: Create Transaction
        body:
          application/json:
            type: FinancialTransaction
            example:
              transactionNumber: "TXN-20260128-001"
              accountId: "a289c8d1-9df9-48a8-8e45-4d5e2f573ee5"
              transactionType: "Debit"
              amount: 100.00
              currency: "USD"
              transactionDate: "2026-01-28T10:30:00Z"
              description: "Purchase at Store XYZ"
              status: "Posted"
        responses:
          201:
            body:
              application/json:
                type: FinancialTransaction

/transactions/{transactionId}:
  displayName: Transaction by ID
  uriParameters:
    transactionId:
      type: string
  get:
    displayName: Get Transaction by ID
    responses:
      200:
        body:
          application/json:
            type: FinancialTransaction
  put:
    displayName: Update Transaction
    body:
      application/json:
        type: FinancialTransaction
        example:
          transactionNumber: "TXN-20260128-001"
          accountId: "a289c8d1-9df9-48a8-8e45-4d5e2f573ee5"
          transactionType: "Debit"
          amount: 100.00
          currency: "USD"
          transactionDate: "2026-01-28T10:30:00Z"
          description: "Purchase at Store XYZ"
          status: "Posted"
    responses:
      200:
        body:
          application/json:
            type: FinancialTransaction
  /dispute:
    displayName: Dispute Transaction
    post:
      displayName: Create Dispute
      body:
        application/json:
          type: object
          properties:
            disputeReason: string
          example:
            disputeReason: "Unauthorized transaction"
      responses:
        200:
          body:
            application/json:
              type: FinancialTransaction
